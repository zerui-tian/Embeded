C51 COMPILER V8.08   0                                                                     08/18/2015 21:50:06 PAGE 1   


C51 COMPILER V8.08, COMPILATION OF MODULE 0
OBJECT MODULE PLACED IN 0.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE 0.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /*********************************************************************************
   2          * ¡¾±àÐ´Ê±¼ä¡¿£º 2014Äê3ÔÂ5ÈÕ
   3          * ¡¾×÷    Õß¡¿£º ÇåÏèµç×Ó:03
   4          * ¡¾°æ    ±¾¡¿£º 1.0
   5          * ¡¾Íø    Õ¾¡¿£º http://www.qxmcu.com/ 
   6          * ¡¾ÌÔ±¦µêÆÌ¡¿£º http://qxmcu.taobao.com/ 
   7          * ¡¾ÊµÑéÆ½Ì¨¡¿£º QX-MCS51 µ¥Æ¬»ú¿ª·¢°å
   8          * ¡¾Íâ²¿¾§Õñ¡¿£º 11.0592mhz     
   9          * ¡¾Ö÷¿ØÐ¾Æ¬¡¿£º STC89C52
  10          * ¡¾±àÒë»·¾³¡¿£º Keil ¦ÌVisio3  
  11          * ¡¾³ÌÐò¹¦ÄÜ¡¿£º ÓÉÓÚ24c02ÊÇÃ¿¸ö´æ´¢µØÖ·Ö»¶ÔÓ¦8¸öbitµÄ´æ´¢¿Õ¼ä£¬¼´Ò»¸ö
  12                                  ´æ´¢µ¥ÔªËù´æ´¢µÄÊý¾Ý×î´óÎª255£¬¸ÃÀý³Ì½éÉÜÁËÒ»ÖÖµ±Ëù¼ÇÒä
  13                                  Êý¾Ý´óÓÚ255£¨¶øÐ¡ÓÚ65536£©µÄ´æ´¢·½·¨¡£¼´ÓÃÁ½¸ö´æ´¢µ¥ÔªÀ´
  14                                  ´æ´¢Ò»¸öÊý¾Ý¡£
  15                                  ÏÂÔØ³ÌÐòºó£¬ÊýÂë¹Ü»áÏÔÊ¾ËùÉè¶¨µÄnumÖµ£¨´Ë´¦ÉèÎª12345£©¡£                                                                                    
  16          * ¡¾Ê¹ÓÃËµÃ÷¡¿£º 
  17          *  ËµÃ÷£ºÃâ·Ñ¿ªÔ´£¬²»Ìá¹©Ô´´úÂë·ÖÎö.
  18          **********************************************************************************/
  19          
  20          #include<reg51.h>
  21          #include <intrins.h>
  22          #define uint unsigned int
  23          #define uchar unsigned char
  24          uint num,num1,num2;        //¶¨Òå¼ÆÊýÖµ£¬Ã¿¹ý1Ãë£¬sec¼Ó1
  25          sbit sda=P2^0;                          //IO¿Ú¶¨Òå
  26          sbit scl=P2^1;
  27          sbit dula=P2^6;
  28          sbit wela=P2^7;
  29          sbit s1=P3^4;//¼ÆÊý°´¼ü
  30          sbit s2=P3^5;//ÇåÁã°´¼ü
  31          unsigned char j,k;
  32          char a,b,c,d,e;
  33          
  34          void delay(unsigned char i)             //ÑÓÊ±³ÌÐò
  35          {
  36   1        for(j=i;j>0;j--)
  37   1          for(k=125;k>0;k--);
  38   1      }
  39          
  40          uchar code table[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,                         //ÊýÂë¹Ü±àÂë
  41                                  0x07,0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x71};
  42          
  43          void nop()
  44          {
  45   1              _nop_();
  46   1              _nop_();
  47   1      }
  48          void display(uchar a,b,c,d,e)                   //ÏÔÊ¾³ÌÐò
  49          {
  50   1         dula=0;
  51   1         P0=table[a];         //ÏÔÊ¾ÍòÎ»
  52   1         dula=1;
  53   1         dula=0;
  54   1      
  55   1         wela=0;
C51 COMPILER V8.08   0                                                                     08/18/2015 21:50:06 PAGE 2   

  56   1         P0=0xfe;
  57   1         wela=1;
  58   1         wela=0;
  59   1         delay(5);
  60   1      
  61   1         dula=0;
  62   1         P0=table[b];         //ÏÔÊ¾Ç§Î»
  63   1         dula=1;
  64   1         dula=0;
  65   1      
  66   1         wela=0;
  67   1         P0=0xfd;
  68   1         wela=1;
  69   1         wela=0;
  70   1         delay(5);
  71   1      
  72   1         dula=0;
  73   1         P0=table[c];         //ÏÔÊ¾°ÙÎ»
  74   1         dula=1;
  75   1         dula=0;
  76   1      
  77   1         wela=0;
  78   1         P0=0xfb;
  79   1         wela=1;
  80   1         wela=0;
  81   1         delay(5);
  82   1      
  83   1         dula=0;
  84   1         P0=table[d];         //ÏÔÊ¾Ê®Î»
  85   1         dula=1;
  86   1         dula=0;
  87   1      
  88   1         wela=0;
  89   1         P0=0xf7;
  90   1         wela=1;
  91   1         wela=0;
  92   1         delay(5);
  93   1      
  94   1         dula=0;
  95   1         P0=table[e];         //ÏÔÊ¾¸öÎ»
  96   1         dula=1;
  97   1         dula=0;
  98   1      
  99   1         wela=0;
 100   1         P0=0xef;
 101   1         wela=1;
 102   1         wela=0;
 103   1         delay(5);
 104   1               
 105   1      }
 106          
 107          /////////24C02¶ÁÐ´Çý¶¯³ÌÐò////////////////////
 108          void delay1(unsigned int m)
 109          {       unsigned int n;
 110   1              for(n=0;n<m;n++);
 111   1      }
 112          
 113          void init()  //24c02³õÊ¼»¯×Ó³ÌÐò
 114          {
 115   1              scl=1;
 116   1              nop();
 117   1              sda=1;
C51 COMPILER V8.08   0                                                                     08/18/2015 21:50:06 PAGE 3   

 118   1              nop();
 119   1      }
 120          
 121          void start()        //Æô¶¯I2C×ÜÏß
 122          {
 123   1              sda=1;
 124   1              nop();
 125   1              scl=1;
 126   1              nop();
 127   1              sda=0;
 128   1              nop();
 129   1              scl=0;
 130   1              nop();
 131   1      }
 132          
 133          void stop()         //Í£Ö¹I2C×ÜÏß
 134          {
 135   1              sda=0;
 136   1              nop();
 137   1              scl=1;
 138   1              nop();
 139   1              sda=1;
 140   1              nop();
 141   1      }
 142          
 143          void writebyte(unsigned char j)  //Ð´Ò»¸ö×Ö½Ú
 144          {
 145   1              unsigned char i,temp;
 146   1              temp=j;
 147   1              for (i=0;i<8;i++)
 148   1         {
 149   2                 temp=temp<<1;
 150   2                 scl=0;
 151   2                 nop();
 152   2                 sda=CY;              //temp×óÒÆÊ±£¬ÒÆ³öµÄÖµ·ÅÈëÁËCYÖÐ
 153   2                 nop();
 154   2                 scl=1;               //´ýsdaÏßÉÏµÄÊý¾ÝÎÈ¶¨ºó£¬½«sclÀ­¸ß
 155   2                 nop();
 156   2         }
 157   1         scl=0;
 158   1         nop();
 159   1         sda=1;
 160   1         nop();
 161   1      }
 162          
 163          unsigned char readbyte()   //¶ÁÒ»¸ö×Ö½Ú
 164          {
 165   1         unsigned char i,j,k=0;
 166   1         scl=0; nop(); sda=1;
 167   1         for (i=0;i<8;i++)
 168   1         {  
 169   2                      nop(); scl=1; nop();
 170   2              if(sda==1) 
 171   2                      j=1;
 172   2              else
 173   2                      j=0;
 174   2              k=(k<<1)|j;
 175   2                      scl=0;
 176   2              }
 177   1              nop();
 178   1              return(k);
 179   1      }
C51 COMPILER V8.08   0                                                                     08/18/2015 21:50:06 PAGE 4   

 180          
 181          void clock()         //I2C×ÜÏßÊ±ÖÓ
 182          {
 183   1         unsigned char i=0;
 184   1         scl=1;
 185   1         nop();
 186   1         while((sda==1)&&(i<255))
 187   1                i++;
 188   1         scl=0;
 189   1         nop();
 190   1      }
 191          
 192          ////////´Ó24c02µÄµØÖ·addressÖÐ¶ÁÈ¡Ò»¸ö×Ö½ÚÊý¾Ý/////
 193          unsigned char read24c02(unsigned char address)
 194          {
 195   1         unsigned char i;
 196   1         start();
 197   1         writebyte(0xa0);
 198   1         clock();
 199   1         writebyte(address);
 200   1         clock();
 201   1         start();
 202   1         writebyte(0xa1);
 203   1         clock();
 204   1         i=readbyte();
 205   1         stop();
 206   1         delay1(100);
 207   1         return(i);
 208   1      }
 209          
 210          //////Ïò24c02µÄaddressµØÖ·ÖÐÐ´ÈëÒ»×Ö½ÚÊý¾Ýinfo/////
 211          void write24c02(unsigned char address,unsigned char info)
 212          {
 213   1         start();
 214   1         writebyte(0xa0);
 215   1         clock();
 216   1         writebyte(address);
 217   1         clock();
 218   1         writebyte(info);
 219   1         clock();
 220   1         stop();
 221   1         delay1(5000); //Õâ¸öÑÓÊ±Ò»¶¨Òª×ã¹»³¤£¬·ñÔò»á³ö´í¡£ÒòÎª24c02ÔÚ´ÓsdaÉÏÈ¡µÃÊý¾Ýºó£¬»¹ÐèÒªÒ»¶¨Ê±¼äµÄÉÕÂ¼¹ý³
             -Ì¡£
 222   1      }
 223          
 224          void main()
 225          {
 226   1              init();        //³õÊ¼»¯24C02
 227   1              num=12345;         //numÎªÐ¡ÓÚµÈÓÚ65535µÄÕûÊý¡£
 228   1              num2=num/256;
 229   1              num1=num%256;
 230   1              write24c02(0,num1);
 231   1              write24c02(1,num2);
 232   1              num1=read24c02(0);      //ÓÃµØÖ·0µ¥Ôª´æ´¢numÊ®Áù½øÖÆ±íÊ¾Ê±µÄµÍÁ½Î»
 233   1              num2=read24c02(1);      //ÓÃµØÖ·0µ¥Ôª´æ´¢numÊ®Áù½øÖÆ±íÊ¾Ê±µÄ¸ßÁ½Î»
 234   1              num=num2*256+num1;
 235   1              a=num/10000;
 236   1              b=num%10000/1000;
 237   1              c=num%1000/100;
 238   1              d=num%100/10;
 239   1              e=num%10;
 240   1              while(1)
C51 COMPILER V8.08   0                                                                     08/18/2015 21:50:06 PAGE 5   

 241   1              display(a,b,c,d,e);
 242   1      }
 243          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    618    ----
   CONSTANT SIZE    =     16    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     13       9
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
